
SELECT count(*) FROM GXTRJDTA.TCOAUX WHERE    AUXFEHO >= '2020-08-01-00.00.00.000000' AND AUXFEHO <= '2020-08-31-23.59.59.000000' AND  AUXTBL = 'TMCTAAF'  ;

SELECT DISTINCT (AUXEST ),count(AUXEST) FROM GXTRJDTA.TCOAUX WHERE    AUXFEHO >= '2020-08-01-00.00.00.000000' AND AUXFEHO <= '2020-08-31-23.59.59.000000' AND  AUXTBL = 'TMCTAAF' GROUP by (auxest)  ;


SELECT * 
FROM  GXTRJDTA.TCOAUX x   
LEFT OUTER JOIN  GXBDBPS.TMCTAAF A  ON 	SUBSTRING(MCNUMCT,1,12) =  SUBSTRING(AUXCLAV,1,12)
WHERE    AUXFEHO >= '2020-08-01-00.00.00.000000' AND AUXFEHO <= '2020-08-31-23.59.59.000000' AND  AUXTBL = 'TMCTAAF' AND   NOT  MCNUMCT IS null  AND auxest = 'N'; 










SELECT * FROM GXTRJDTA.TCOAUX  WHERE  AUXFEHO >= '2020-08-01-00.00.00.000000' AND AUXFEHO <= '2020-08-31-23.59.59.000000'   AND  AUXTBL = 'TMCTAAF' AND   AUXCLAV = '20110500009                                         ';
SELECT * FROM GXTRJDTA.TCOAUX t  WHERE AUXCLAV = '20110500009                                       ';
--  SUBSTRING(AUXCLAV,1,12), AUXEST, MCNUMCT



SELECT  COUNT (*)
FROM  GXTRJDTA.TCOAUX x   
LEFT OUTER JOIN  GXBDBPS.TMCTAAF A  ON 	SUBSTRING(MCNUMCT,0,12) =  SUBSTRING(AUXCLAV,0,12)
LEFT JOIN GXTRJDTA.TCOENC C ON C.EnCEntAnt = A.MCEMISO
LEFT JOIN GXTRJDTA.TCoEAC D ON D.EACEntAct = C.ENCENTACT AND D.EACEntAnt = C.EnCEntAnt AND D.EACAfiAnt = A.MCAFINI AND D.EACBINAnt = A.MCBINES
LEFT JOIN  GXTRJDTA.TDSDPS G  ON  DPSSECUE=  c.ENCENTACT 
LEFT JOIN  GXTRJDTA.TTCCTA F ON SUBSTRING(AUXCLAV,1,12) = SUBSTRING(CTAIDCTA ,1,12)
JOIN GXTRJDTA.TDGAFI E ON E.ENTCODENT = D.EACEntAct AND E.AFICODAFI = D.EACAFIACT
WHERE AUXTBL = 'TMCTAAF'   AND AUXFEHO >= '2020-09-01-00.00.00.000000' AND AUXFEHO <= '2020-09-08-23.59.59.000000' AND PaSIdParSi='ACTUALIZACIONKBTRJ' AND  auxest = 'N';--                                       ';--GROUP BY (AUXCLAV)  ;--  AND  MCNUMCT IS NULL  ;  0--




SELECT auxclav,MCFEUCA, auxest FROM GXBDBPS.TMCTAAF  INNER JOIN  GXTRJDTA.TCOAUX ON  	SUBSTRING(MCNUMCT,0,12)  =  SUBSTRING(AUXCLAV,0,12) WHERE AUXEST = 'N' AND  AUXTBL = 'TMCTAAF'  ;


 SELECT * FROM GXTRJDTA.TCoEAC WHERE EACENTANT = ;







-- cuenta con datos financieros TTCCTA-TTCCDF
SELECT count(*)-- x.*,a.*--*, a.CTAIDCTA, a.CTANMCTA, B.* 
FROM GXTRJDTA.TTCCTA A 
FULL OUTER JOIN GXTRJDTA.TTCCDF B ON A.CTAIDCTA = B .CTAIDCTA
FULL OUTER JOIN   GXTRJDTA.TCOAUX x ON  SUBSTRING(AUXCLAV,0,12) = SUBSTRING(a.CTAIDCTA ,0,12)
WHERE AUXTBL = 'TMCTAAF'  AND AUXFEHO >= '2020-08-01-00.00.00.000000' AND AUXFEHO <= '2020-08-31-23.59.59.000000'   AND AUXEST = 'N' AND   A.CTAIDCTA IS NULL;--  AND  MCNUMCT IS NULL  ;  0--;





SELECT DISTINCT(AUXCLAV),count(*) FROM  GXTRJDTA.TCOAUX x    WHERE AUXTBL = 'TMCTAAF'  AND AUXFEHO >= '2020-08-01-00.00.00.000000' AND AUXFEHO <= '2020-08-31-23.59.59.000000'   GROUP BY (AUXCLAV);








SELECT * FROM  GXTRJDTA.TCOAUX   INNER JOIN GXTRJDTA.TTCCTA t2 t  ON SUBSTRING(AUXCLAV,0,12) = SUBSTRING(CTAIDCTA ,0,12) WHERE AUXTBL = 'TMCTAAF'   AND AUXFEHO >= '2020-08-01-00.00.00.000000' AND AUXFEHO <= '2020-08-31-23.59.59.000000'   AND auxclav = '2030000323' ; 

    
-- cuenta con datos financieros TTCCTA-TTCCDF
SELECT COUNT(*)-- a.CTAIDCTA, a.CTANMCTA, B.* 
FROM GXTRJDTA.TTCCTA A 
FULL OUTER JOIN GXTRJDTA.TTCCDF B ON A.CTAIDCTA = B .CTAIDCTA
JOIN AGAONALIB.TCOAUXST1 t ON  SUBSTRING( AUXCLAV,1,12) = SUBSTRING(a.CTAIDCTA,1,12) 
WHERE   B.CTAIDCTA IS  null;

SELECT * FROM AGAONALIB.TCOAUXAG t ;

-- cuenta con Linea crédito TTCCTA-TTCCLC
SELECT COUNT(*)--a.CTAIDCTA, a.CTANMCTA, B.* 
FROM GXTRJDTA.TTCCTA A 
left OUTER JOIN GXTRJDTA.TTCCLC B ON A.CTAIDCTA = B .CTAIDCTA
JOIN AGAONALIB.TCOAUXST1 t ON  SUBSTRING( AUXCLAV,1,12) = SUBSTRING(a.CTAIDCTA,1,12) 
WHERE B.CTAIDCTA IS  null;











SELECT * FROM AGAONALIB.TCOAUXST1;
SELECT * FROM  GXTRJDTA.TTCCTA ;





SELECT A.*,MCAFINI FROM GXBDBPS.TMCTAAF B
JOIN GXTRJDTA.TCOAUX A ON AUXCLAV = MCNUMCT 
WHERE AUXTBL = 'TMCTAAF'  AND AUXEST =  'N'  AND AUXFEHO >= '2020-08-01-00.00.00.000000' AND AUXFEHO <= '2020-08-31-23.59.59.000000'  ;


SELECT A.*, CTACODAFI FROM GXTRJDTA.TTCCta B
JOIN GXTRJDTA.TCOAUX A ON AUXCLAV = B.CTAIDCTA 
WHERE AUXTBL = 'TMCTAAF'  AND AUXEST =  'N'  AND AUXFEHO >= '2020-08-01-00.00.00.000000' AND AUXFEHO <= '2020-08-31-23.59.59.000000'  ;


































SELECT *
FROM  GXTRJDTA.TCOAUX    
LEFT JOIN  GXBDBPS.TMCTAAF  ON 	SUBSTRING(MCNUMCT,0,12) =  SUBSTRING(AUXCLAV,1,12) AND  MCNUMCT  IS NULL  
WHERE AUXTBL = 'TMCTAAF' ;


SELECT SUBSTRING(AUXCLAV,1,12), MCNUMCT 
FROM  GXTRJDTA.TCOAUX    
left JOIN  GXBDBPS.TMCTAAF  ON 	SUBSTRING(MCNUMCT,0,12) =  SUBSTRING(AUXCLAV,0,12) AND NOT MCNUMCT  IS NULL  
WHERE AUXTBL = 'TMCTAAF' ;




UPDATE gxtrjdta.TCOAUX SET AUXEST = 'X' WHERE AUXEST = 'N';


UPDATE gxtrjdta.TCOAUX SET AUXEST = 'N' WHERE AUXEST = 'X' AND AUXFEHO >= '2020-09-01-00.00.00.000000' AND AUXFEHO <= '2020-09-08-23.59.59.000000';





SELECT *
FROM  GXTRJDTA.TCOAUX x   
LEFT OUTER JOIN  GXBDBPS.TMCTAAF A  ON 	SUBSTRING(MCNUMCT,1,12) =  SUBSTRING(AUXCLAV,1,12)
LEFT JOIN GXTRJDTA.TCOENC C ON C.EnCEntAnt = A.MCEMISO
--LEFT JOIN  GXTRJDTA.TDSDPS G  ON  DPSSECUE=  c.ENCENTACT 
WHERE AUXTBL = 'TMCTAAF'   AND AUXFEHO >= '2020-09-01-00.00.00.000000' AND AUXFEHO <= '2020-09-08-23.59.59.000000' AND auxest ='N'AND    EnCEntAnt IS NULL ;


--GROUP BY (,A.MCEMISO);


SELECT * FROM  GXTRJDTA.TCOENC WHERE EnCEntAnt IN ('318','314','313','309','156');







